(function(){var h,m=[].slice;(function(){var e,f,g,k;f=WebSocket;window.WebSocket=function(c,a){var b=this;console.log("new websocket");this.ws=new f(c,a);this.send=function(){return b.ws.send.apply(b.ws,arguments)};this.close=function(){return b.ws.close.apply(b.ws,arguments)};this.ws.onmessage=function(a){var c;null!=(c=b.onmessage)&&c.apply(b.ws,arguments);return h(a.data,a.currentTarget.url,"ws")};this.ws.onopen=function(){var a;return null!=(a=b.onopen)?a.apply(b.ws,arguments):void 0};this.ws.onerror=
function(){var a;return null!=(a=b.onerror)?a.apply(b.ws,arguments):void 0};this.ws.onclose=function(){var a;return null!=(a=b.onerror)?a.apply(b.ws,arguments):void 0};return this};k=window.XMLHttpRequest;window.XMLHttpRequest=function(c){var a,b;b=new k(c);a=b.open;b.open=function(c,e,f,g,k){var l,d;d=e.split("?");l=d[0];d=new URLSearchParams(d[1]);d.get("fields")&&-1!==e.toLowerCase().indexOf("1/boards/")?(d.set("fields",Array.from(new Set(d.get("fields").split(",").concat(["name","closed","shortUrl",
"idBoard"])))),d.set("list",!0),d.set("customFields",!0),d.set("card_customFieldItems",!0),arguments[1]=[l,d.toString()].join("?")):-1!==e.toLowerCase().indexOf("/1/cards/")&&d.get("fields")&&(d.set("list",!0),d.set("board",!0),arguments[1]=[l,d.toString()].join("?"));a.apply(b,arguments);return this.addEventListener("readystatechange",function(){if(4===this.readyState&&200===this.status)return h(this.response,e,c.toLowerCase())},!1)};return b};e=function(){var c,a;a=g(window.location.href);c=a.action_type;
a=a.entityShortUrl;if(c)return c=new CustomEvent(c,{detail:{data:{entityShortUrl:a},url:window.location.href}}),window.dispatchEvent(c)};g=function(c){var a,b;b=c.replace("//","/").split("/");a=b[2];c=b[3];5<=b.length&&m.call(b,4);a:switch(a){case "c":a="trello-card-opened";break a;default:a=null}return{action_type:a,entityShortUrl:c}};e();return function(c){return function(a){return history.pushState=function(){a.apply(this,arguments);return c.apply(window,arguments)}}(history.pushState)}(e)})();
h=function(e,f,g){e=new CustomEvent("trello-data-received",{detail:{data:e,url:f,method:g}});return window.dispatchEvent(e)}}).call(this);
